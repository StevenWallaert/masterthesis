---
output: 
  bookdown::pdf_document2:
    number_sections: yes
    toc: yes
    keep_tex: true
bibliography: biblio.bib
header-includes: \usepackage{amsmath} \usepackage{setspace}
editor_options: 
  chunk_output_type: console
---
---
nocite: |
  @glmnet, @svmrfe
...
\onehalfspacing

\thispagestyle{empty}


\clearpage

\setcounter{page}{0}

\newpage

\thispagestyle{empty}

# Foreword {-}

The work for this thesis consisted for the most part of coding, executing, interpreting and writing down the results of a simulation study. Conceptual foundation of this study, as well as guidance in planning and executing, was given by professor Thas, for which I am thankful. Unless explicitly specified, all code and text is written by myself. The data for the simulation study was generated by myself on my laptop with its own limitations. The data used in the example analysis comes from a publicly available data set that can be downloaded from http://bioinf.wehi.edu.au/limma/data/ecoli-lrp.zip.

The most important people to thank are my wife and daughter, for their patience and understanding. They have believed in me and have supported me from day one. Tine and Oona, completing the mastat while making the combination with work and family life has been an utter challenge and I could not have done it without you. 



\newpage

\clearpage

\setcounter{page}{1}

```{r, child="00-abstract.Rmd"}

```

\newpage

```{r, child="01-introduction.Rmd"}

```

\newpage

```{r, child="02-method.Rmd"}

```

\newpage

```{r, child="03-results.Rmd"}

```

\newpage

```{r, child="04-discussion.Rmd"}

```

# References

<div id="refs"></div>

\newpage


# (APPENDIX) Appendix {-}


# Appendix: Exploratory results {#exploratory}

All plots in this section show 95% confidence intervals.


```{r, echo=F, message=F}
library(tidyverse)

library(ggrepel)

files <- dir("output/")
files_detect <- files[str_detect(files, "detect.csv$")]

df_detect <- map_df(files_detect, function(x){
  read_csv(paste0("output/", x))
})

files_perf <- files[str_detect(files, "perf.csv$")]
df_perf <- map_df(files_perf, function(x){
  read_csv(paste0("output/", x))
})

files_null <- files[str_detect(files, "null.csv$")]
df_null <- map_df(files_null, function(x){
  read_csv(paste0("output/", x))
})

files_time <- files[str_detect(files, "time.csv$")]
df_time <- map_df(files_time, function(x){
  read_csv(paste0("output/", x))
})
```

## n = 76, sig_p = 10, uncorrelated, d = varying

```{r, out.width="49%", fig.align='center', fig.height=7, fig.show="hold", message=F, warning=F, echo=F}
d_ <- 1.81
nsims_ <- 10
sig_p_ <- 10
n_ <- 76
correlated_ <- "no"

exploratory_plot1 <- function(d_, nsims_, sig_p_, n_, correlated_){
  df_detect %>%
filter(d == d_, nsims == nsims_, sig_p == sig_p_, n == n_, is.na(correlated)) %>%
ggplot(aes(x=p, y=mean_nr)) +
geom_point(aes(color = method)) +
geom_line(aes(group = method, color = method)) +
geom_errorbar(aes(ymin=mean_nr-1.96*mean_se, ymax=mean_nr+1.96*mean_se, color = method), width = 0.1, alpha = 0.7) +
scale_x_log10(breaks=c(100,300,1000,3000,1e4), labels = scales::comma_format() )  +
facet_grid(detection~., scales="free", labeller = labeller(method = c("boruta" = "Boruta",
                                                                           "fdr" = "t-test + FDR",
                                                                           "lasso" = "Logistic Lasso",
                                                                           "svm" = "SVMRFE top 1%",
                                                                           "tweedie" = "t-test + Tweedie"))) +
  labs(x = "Number of features",
       y = "Mean number of discoveries",
       title = paste0("n = ", n_, ", sig_p = ", sig_p_, ", d = ", d_, ", ", correlated_, " correlation", ", nsims = ", nsims_)) +
  theme_bw() +
  scale_y_log10() +
  scale_color_brewer(palette = "Set1") +
  geom_hline(yintercept = sig_p_, color = "grey", lty = "dashed") +
  geom_label_repel(data = df_detect %>%
  filter(d == d_, nsims == nsims_, n == n_, sig_p == sig_p_, is.na(correlated), p == 10000), aes(label = method, color = method), alpha = 0.75) +
  theme(legend.position = "none",
        title = element_text(size = 9, color = "#444444"))
}

exploratory_plot2 <- function(d_, nsims_, sig_p_, n_, correlated_){
  df_detect %>%
  filter(d == d_, nsims == nsims_, n == n_, is.na(correlated), sig_p == sig_p_) %>%
  ggplot(aes(x = p, y=a_detection, color = method, group = method)) +
  geom_point() +
  geom_line() +
  geom_errorbar(aes(ymin =a_detection - 1.96*a_det_se, ymax= a_detection + 1.96*a_det_se), width = 0.1) +
  scale_x_log10(breaks=c(100,300,1000,3000,1e4), labels = scales::comma_format()) +
  facet_grid(detection~.) +
  #lims(y = c(-0.1,1.1)) +
  theme_bw() +
  scale_color_brewer(palette = "Set1") +
  geom_label_repel(data = df_detect %>%
  filter(d == d_, nsims == nsims_, n == n_, is.na(correlated), p == 10000, sig_p_ == sig_p_), aes(label = method), alpha = 0.75) +
  labs(x = "Number of features",
       y = "Chance of at least one discovery",
       title = paste0("n = ", n_, ", sig_p = ", sig_p_, ", d = ", d_, ", ", correlated_, " correlation", ", nsims = ", nsims_)) +
   theme(legend.position = "none",
        title = element_text(size = 9, color = "#444444"))
}

exploratory_plot1(d_, nsims_, sig_p_, n_, correlated_)
exploratory_plot2(d_, nsims_, sig_p_, n_, correlated_)
```


```{r, out.width="49%", fig.align='center', fig.height=7, fig.show="hold", message=F, warning=F, echo=F}
d_ <- 1.1
nsims_ <- 10
sig_p_ <- 10
n_ <- 76
correlated_ <- "no"


exploratory_plot1(d_, nsims_, sig_p_, n_, correlated_)
exploratory_plot2(d_, nsims_, sig_p_, n_, correlated_)
```


```{r, out.width="49%", fig.align='center', fig.height=7, fig.show="hold", message=F, warning=F, echo=F}
d_ <- 0.9
nsims_ <- 10
sig_p_ <- 10
n_ <- 76
correlated_ <- "no"

exploratory_plot1(d_, nsims_, sig_p_, n_, correlated_)
exploratory_plot2(d_, nsims_, sig_p_, n_, correlated_)
```

```{r, out.width="49%", fig.align='center', fig.height=7, fig.show="hold", message=F, warning=F, echo=F}
d_ <- 0.7
nsims_ <- 10
sig_p_ <- 10
n_ <- 76
correlated_ <- "no"

exploratory_plot1(d_, nsims_, sig_p_, n_, correlated_)
exploratory_plot2(d_, nsims_, sig_p_, n_, correlated_)
```


```{r, out.width="49%", fig.align='center', fig.height=7, fig.show="hold", message=F, warning=F, echo=F}
d_ <- 0.5
nsims_ <- 10
sig_p_ <- 10
n_ <- 76
correlated_ <- "no"

exploratory_plot1(d_, nsims_, sig_p_, n_, correlated_)
exploratory_plot2(d_, nsims_, sig_p_, n_, correlated_)
```


```{r, out.width="49%", fig.align='center', fig.height=7, fig.show="hold", message=F, warning=F, echo=F}
d_ <- 0.3
nsims_ <- 10
sig_p_ <- 10
n_ <- 76
correlated_ <- "no"

exploratory_plot1(d_, nsims_, sig_p_, n_, correlated_)
exploratory_plot2(d_, nsims_, sig_p_, n_, correlated_)
```


```{r, out.width="49%", fig.align='center', fig.height=7, fig.show="hold", message=F, warning=F, echo=F}
d_ <- 0.1
nsims_ <- 10
sig_p_ <- 10
n_ <- 76
correlated_ <- "no"

exploratory_plot1(d_, nsims_, sig_p_, n_, correlated_)
exploratory_plot2(d_, nsims_, sig_p_, n_, correlated_)
```


## n = 10, sig_p = 1, uncorrelated, d = varying

```{r, out.width="49%", fig.align='center', fig.height=7, fig.show="hold", message=F, warning=F, echo=F}
d_ <- 0.36
nsims_ <- 10
sig_p_ <- 1
n_ <- 10
correlated_ <- "no"

exploratory_plot1(d_, nsims_, sig_p_, n_, correlated_)
exploratory_plot2(d_, nsims_, sig_p_, n_, correlated_)
```

```{r, out.width="49%", fig.align='center', fig.height=7, fig.show="hold", message=F, warning=F, echo=F}
d_ <- 0.5
nsims_ <- 10
sig_p_ <- 1
n_ <- 10
correlated_ <- "no"

exploratory_plot1(d_, nsims_, sig_p_, n_, correlated_)
exploratory_plot2(d_, nsims_, sig_p_, n_, correlated_)
```

```{r, out.width="49%", fig.align='center', fig.height=7, fig.show="hold", message=F, warning=F, echo=F}
d_ <- 0.7
nsims_ <- 10
sig_p_ <- 1
n_ <- 10
correlated_ <- "no"

exploratory_plot1(d_, nsims_, sig_p_, n_, correlated_)
exploratory_plot2(d_, nsims_, sig_p_, n_, correlated_)
```


```{r, out.width="49%", fig.align='center', fig.height=7, fig.show="hold", message=F, warning=F, echo=F}
d_ <- 0.9
nsims_ <- 10
sig_p_ <- 1
n_ <- 10
correlated_ <- "no"

exploratory_plot1(d_, nsims_, sig_p_, n_, correlated_)
exploratory_plot2(d_, nsims_, sig_p_, n_, correlated_)
```

```{r, out.width="49%", fig.align='center', fig.height=7, fig.show="hold", message=F, warning=F, echo=F}
d_ <- 1.1
nsims_ <- 10
sig_p_ <- 1
n_ <- 10
correlated_ <- "no"

exploratory_plot1(d_, nsims_, sig_p_, n_, correlated_)
exploratory_plot2(d_, nsims_, sig_p_, n_, correlated_)
```

```{r, out.width="49%", fig.align='center', fig.height=7, fig.show="hold", message=F, warning=F, echo=F}
d_ <- 1.3
nsims_ <- 10
sig_p_ <- 1
n_ <- 10
correlated_ <- "no"

exploratory_plot1(d_, nsims_, sig_p_, n_, correlated_)
exploratory_plot2(d_, nsims_, sig_p_, n_, correlated_)
```

```{r, out.width="49%", fig.align='center', fig.height=7, fig.show="hold", message=F, warning=F, echo=F}
d_ <- 1.5
nsims_ <- 10
sig_p_ <- 1
n_ <- 10
correlated_ <- "no"

exploratory_plot1(d_, nsims_, sig_p_, n_, correlated_)
exploratory_plot2(d_, nsims_, sig_p_, n_, correlated_)
```

```{r, out.width="49%", fig.align='center', fig.height=7, fig.show="hold", message=F, warning=F, echo=F}
d_ <- 1.7
nsims_ <- 10
sig_p_ <- 1
n_ <- 10
correlated_ <- "no"

exploratory_plot1(d_, nsims_, sig_p_, n_, correlated_)
exploratory_plot2(d_, nsims_, sig_p_, n_, correlated_)
```

```{r, out.width="49%", fig.align='center', fig.height=7, fig.show="hold", message=F, warning=F, echo=F}
d_ <- 1.81
nsims_ <- 10
sig_p_ <- 1
n_ <- 10
correlated_ <- "no"

exploratory_plot1(d_, nsims_, sig_p_, n_, correlated_)
exploratory_plot2(d_, nsims_, sig_p_, n_, correlated_)
```

## n = 30, sig_p = 3, uncorrelated, d = varying

```{r, out.width="49%", fig.align='center', fig.height=7, fig.show="hold", message=F, warning=F, echo=F}
d_ <- 0.95
nsims_ <- 10
sig_p_ <- 3
n_ <- 30
correlated_ <- "no"

exploratory_plot1(d_, nsims_, sig_p_, n_, correlated_)
exploratory_plot2(d_, nsims_, sig_p_, n_, correlated_)
```

```{r, out.width="49%", fig.align='center', fig.height=7, fig.show="hold", message=F, warning=F, echo=F}
d_ <- 0.7
nsims_ <- 10
sig_p_ <- 3
n_ <- 30
correlated_ <- "no"

exploratory_plot1(d_, nsims_, sig_p_, n_, correlated_)
exploratory_plot2(d_, nsims_, sig_p_, n_, correlated_)
```

```{r, out.width="49%", fig.align='center', fig.height=7, fig.show="hold", message=F, warning=F, echo=F}
d_ <- 0.5
nsims_ <- 10
sig_p_ <- 3
n_ <- 30
correlated_ <- "no"

exploratory_plot1(d_, nsims_, sig_p_, n_, correlated_)
exploratory_plot2(d_, nsims_, sig_p_, n_, correlated_)
```

```{r, out.width="49%", fig.align='center', fig.height=7, fig.show="hold", message=F, warning=F, echo=F}
d_ <- 0.3
nsims_ <- 10
sig_p_ <- 3
n_ <- 30
correlated_ <- "no"

exploratory_plot1(d_, nsims_, sig_p_, n_, correlated_)
exploratory_plot2(d_, nsims_, sig_p_, n_, correlated_)
```

```{r, out.width="49%", fig.align='center', fig.height=7, fig.show="hold", message=F, warning=F, echo=F}
d_ <- 1.1
nsims_ <- 10
sig_p_ <- 3
n_ <- 30
correlated_ <- "no"

exploratory_plot1(d_, nsims_, sig_p_, n_, correlated_)
exploratory_plot2(d_, nsims_, sig_p_, n_, correlated_)
```

```{r, out.width="49%", fig.align='center', fig.height=7, fig.show="hold", message=F, warning=F, echo=F}
d_ <- 1.3
nsims_ <- 10
sig_p_ <- 3
n_ <- 30
correlated_ <- "no"

exploratory_plot1(d_, nsims_, sig_p_, n_, correlated_)
exploratory_plot2(d_, nsims_, sig_p_, n_, correlated_)
```

```{r, out.width="49%", fig.align='center', fig.height=7, fig.show="hold", message=F, warning=F, echo=F}
d_ <- 1.5
nsims_ <- 10
sig_p_ <- 3
n_ <- 30
correlated_ <- "no"

exploratory_plot1(d_, nsims_, sig_p_, n_, correlated_)
exploratory_plot2(d_, nsims_, sig_p_, n_, correlated_)
```

```{r, out.width="49%", fig.align='center', fig.height=7, fig.show="hold", message=F, warning=F, echo=F}
d_ <- 1.7
nsims_ <- 10
sig_p_ <- 3
n_ <- 30
correlated_ <- "no"

exploratory_plot1(d_, nsims_, sig_p_, n_, correlated_)
exploratory_plot2(d_, nsims_, sig_p_, n_, correlated_)
```

```{r, out.width="49%", fig.align='center', fig.height=7, fig.show="hold", message=F, warning=F, echo=F}
d_ <- 1.81
nsims_ <- 10
sig_p_ <- 3
n_ <- 30
correlated_ <- "no"

exploratory_plot1(d_, nsims_, sig_p_, n_, correlated_)
exploratory_plot2(d_, nsims_, sig_p_, n_, correlated_)
```

```{r, out.width="49%", fig.align='center', fig.height=7, fig.show="hold", message=F, warning=F, echo=F}
d_ <- 2
nsims_ <- 10
sig_p_ <- 3
n_ <- 30
correlated_ <- "no"

exploratory_plot1(d_, nsims_, sig_p_, n_, correlated_)
exploratory_plot2(d_, nsims_, sig_p_, n_, correlated_)
```


# Appendix: Session info {#sessioninfo}

```{r echo=FALSE, comment=""}
sessionInfo()
```


# Appendix: Code

All code can be downloaded from https://github.com/StevenWallaert/masterthesis.